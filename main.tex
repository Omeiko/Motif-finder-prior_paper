\documentclass{article}
\usepackage{fancyvrb}
% \usepackage[style=alphabetic]{biblatex}
\begin{document}
\title{Enhancing Hi-C contact map resolution with neural network}
\author{}
\maketitle

\input{introduction}

\section{Methods}


Let $D$ be a set of paired ends reads of a Hi-C experiment. 
We make a low and high contact maps from $D$, denoted by $M_\ell$ and $M_h$. 
Let $S_\ell$ and $S_h$ be the size of $M_\ell$ and $M_h$. 
Let $R$ be the ratio of $M_\ell$ to $M_h$, which can be represented by
$R = \frac{M_h}{M_\ell}$. And $O$ be the number of overlapping pixels between adjacent sub-maps.
% algorithm 環境にする．

\begin{Verbatim}[commandchars=\\\{\},codes={\catcode`$=3\catcode`_=8\catcode`^=7}]
% Divide matrices $M_\ell$ and $M_h$ \

To $M_\ell:$

for $i$ = 1, 1+$40-O$, 1+2$\times(40-O)$, ...
    for $j$ = 1, 1+$40-O$, 1+2$\times(40-O)$, ...
        IF $i+40$ > $M_\ell$ || $j+40$ > $M_\ell$, BREAK 
        ELSE extract 40 $\times$ 40 sub-maps whose left-top coordinate
         is $(i,j)$ from $M_\ell$.

Do the same process to $M_h:$

for $i$ = 1, 1+$(40-O) \times R$, 1+2$\times(40-O) \times R$, ...
    for $j$ = 1, 1+$(40-O) \times R$, 1+2$\times(40-O) \times R$, ...
        IF $i+40 \times R$ > $M_h$ || $j+40 \times R$ > $M_h$, BREAK 
        ELSE extract $(40 \times R) \times (40 \times R)$ sub-maps whose left-top 
        coordinate is $(i,j)$ from $M_h$.
\end{Verbatim}

% training part: 


\noindent Let $C_\ell$ and $C_h$ be a collection of the resulting sub-maps. 
Train a neural network using $C_\ell$ and $C_h$. Mean square error is used as 
loss function in the training process. 

\begin{center}
    $MSE[C_\ell, C_h] = \frac{1}{40 \times 40} \sum_{i=1}^{40 \times 40} (C_{\ell_i}-C_{h_i})^2$
\end{center}


\noindent We can use (f,n) to represent the parameters of each layer. Parameter f means the size of the filter and n means the number of filter. 

\noindent Layer1(Pattern extraction)
Base on every $40 \times 40$ sub-matrix, using $f \times f$( $13 \times 13$ in HiCPlus) filters
to extract patterns of each sub-contact-map. Which can represented by following formula:
\begin{center}
$F_1(X) = ReLU(w_1 * X + b_1)$
\end{center}
Where $*$ represent the convolution process. $w$ represents $n \times f \times f$ filters. 
$b$ is the bias.
 
Layer2(Low-res mapping to high-res)
Layer3(Predicted contact maps generation)


% test part: 
Use other chromosome. 

Do the same dividing process like $M_\ell$ and $M_h$

Calculate the Pearson's correlation between the output and $M_h$.







\subsubsection*{Step 1 Data preparation and processing}
Since this experiment is to validate the algorithm for mapping low-resolution data to high-resolution data, 
high-resolution data are required. 

In order to compare to some state-of-the-art approaches (HiCPlus and HiCNN), 
we use data sets (such as GM12878 from GSE63525) which are also used in other approaches. 
We start from generating a 10kb resolution contact map 
using Hi-C Pro. 
Then we perform down-sampling on high-resolution data. 
We use BAM files to generate low-resolution contact maps by changing the bin size bigger. 
We generate three contact maps with bin sizes are 20kb, 30kb and 40kb, respectively. 
We use chromosome 1-8 as training sets, and chromosome 17 as test set.

\subsubsection*{Step 2 Learning by Neural network}
We separate the low-resolution contact map into many $40 \times 40$ sub-matrices. 
Those sub-matrices are used as inputs.

\subsection{Layer Structure}
We consider the 




\bibliographystyle{acm}
\bibliography{ref} 

\end{document}